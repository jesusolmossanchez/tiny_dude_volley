var Explosion=function(t,i,a,e,l){this.particles=[],this.particulas_por_explosion=15,a&&(this.particulas_por_explosion=45);for(var s=0;s<this.particulas_por_explosion;s++)this.particles.push(new Particle(t,i,a,e,l))},Particle=function(t,i,a,e,l){this.randInt=function(t,i,a){var e;return!1===a?(e=Math.floor(Math.random()*i)-t,e*=1===Math.floor(2*Math.random())?1:-1):e=Math.floor(Math.random()*i)+t,e},this.particlesMinSpeed=3,this.particlesMaxSpeed=8,this.particlesMinSize=1,this.max_particulas_size=8,a&&(this.max_particulas_size=1.5*this.max_particulas_size),e?(this.r=this.randInt(0,255),this.g="0",this.b="0"):a?(this.r=this.randInt(0,255),this.g="255",this.b=this.randInt(0,255)):(this.r="255",this.g="255",this.b=this.randInt(0,255)),this.x=t,this.y=i,this.xv=this.randInt(this.particlesMinSpeed,this.particlesMaxSpeed,!1)+l.dx/300,this.yv=this.randInt(this.particlesMinSpeed/2,this.particlesMaxSpeed/2,!1)+l.dy/300,this.size=this.randInt(this.particlesMinSize,this.max_particulas_size,!0)},Player=function(t,i,a,e,l,s,n){this.timestamp=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},this.bound=function(t,i,a){return Math.max(i,Math.min(a,t))};var h={height:220,width:12,x:420,y:380};this.x=i,this.y=1107,this.alto=110,this.ancho=80,this.dx=0,this.dy=0,this.wasleft=!1,this.wasright=!1,this.gravity=800,this.maxdx=150,this.maxdy=600,this.impulse=6e4,this.accel=this.maxdx/.001,this.friction=this.maxdx/.001,this.player=!0,this.tiempo_enfadado=this.timestamp(),this.tiempo_gorrino=this.timestamp(),this.no_rebota_time=this.timestamp(),this.start={x:this.x,y:this.y},1==s?(this.limite_derecha=420,this.limite_izquierda=0,this.CPU=!1):(this.limite_derecha=840,this.limite_izquierda=420+h.width,this.CPU=!0),this.update=function(t){this.wasleft=this.dx<0,this.wasright=this.dx>0,this.ddx=0,this.ddy=this.gravity,this.left?this.ddx=this.ddx-this.accel:this.wasleft&&(this.ddx=this.ddx+this.friction),this.right?this.ddx=this.ddx+this.accel:this.wasright&&(this.ddx=this.ddx-this.friction),this.jump&&!this.jumping&&(this.tiempo_gorrino<this.timestamp()-50||this.CPU)&&(this.ddy=this.ddy-this.impulse,this.jumping=!0),this.accion&&(this.jumping&&this.timestamp()>this.tiempo_enfadado+300&&(this.tiempo_enfadado=this.timestamp()+400),!this.jumping&&this.timestamp()>this.tiempo_gorrino+300&&(this.tiempo_gorrino=this.timestamp()+400)),this.x=this.x+t*this.dx,this.y=this.y+t*this.dy,this.dx=this.bound(this.dx+t*this.ddx,-this.maxdx,this.maxdx),this.dy=this.bound(this.dy+t*this.ddy,-this.maxdy,this.maxdy),!this.jumping&&this.tiempo_gorrino>this.timestamp()&&(this.haciendo_gorrino?this.tiempo_gorrino>this.timestamp()+150&&(this.gorrino_left?this.dx=-450:this.dx=450):(this.left&&(this.dx=-450,this.haciendo_gorrino=!0,this.gorrino_left=!0),this.right&&(this.dx=450,this.haciendo_gorrino=!0,this.gorrino_left=!1))),this.tiempo_gorrino<this.timestamp()&&(this.haciendo_gorrino=!1),(this.wasleft&&this.dx>0||this.wasright&&this.dx<0)&&(this.dx=0),this.dy>=0&&this.y+this.alto>600&&(this.y=600-this.alto,this.dy=0,this.jumping=!1),this.dx>0?this.haciendo_gorrino?this.x+this.alto+this.ancho/2>=this.limite_derecha&&(this.x=this.limite_derecha-this.alto-this.ancho/2,this.dx=0):this.x+this.ancho>=this.limite_derecha&&(this.x=this.limite_derecha-this.ancho,this.dx=0):this.dx<0&&(this.haciendo_gorrino?this.x-this.alto+this.ancho/2<=this.limite_izquierda&&(this.x=this.limite_izquierda+this.alto-this.ancho/2,this.dx=0):this.x<=this.limite_izquierda&&(this.x=this.limite_izquierda,this.dx=0))},this.pinta_player=function(t,i,a,e,l){var s=this.x+this.dx*i,n=this.y+this.dy*i,h=this.ancho,o=this.alto,r=h/3,c=4,d=s+h/2-(a.x-a.ancho/2);if(t){var p=1,y=12,m=0;this.gorrino_left&&(p=-1,y=0,m=16),e.fillRect(s+this.ancho/2,n+this.ancho/4,p*this.alto,this.ancho),e.fillRect(s+this.ancho/2-y,n+this.ancho/2,12,16),e.fillRect(s+this.ancho/2-y,n+this.ancho/2+30,12,16),e.fillStyle="#ffffff",e.fillRect(s+this.ancho/2+p*(o-h/8)-m,n+this.ancho/2-10,16,16),e.fillRect(s+this.ancho/2+p*(o-h/8)-m,n+this.ancho/2+20,16,16),e.fillStyle="#6e0808",c=12,e.fillRect(s+h/2+p*(o-h/2.5),n+o/2.5,c,r)}else{e.fillRect(s,n,h,o-12);var _=15,u=50;this.tween_frames(l,40)<.5&&(this.left||this.right)&&(u=55),this.tween_frames(l,50)<.5&&(this.left||this.right)&&(_=20);this.jumping&&(_=20,u=40,6),e.fillRect(s+_,n+o-12-1,16,12),e.fillRect(s+u,n+o-12-1,16,12),e.fillStyle="#ffffff";var f=s+h/4-d/15;f=this.bound(f,s-5,s+h/4);var b=s+h-h/8-d/15;b=this.bound(b,s+h/2,s+h-h/8);var x=0;this.jumping&&(x=5),e.fillRect(f,n+h/15-x,16,16),e.fillRect(b,n+h/18-x,16,16),e.fillStyle="#ba001f";var g=s+h/2-d/25;g=this.bound(g,s+h/8,s+h/2),this.jumping&&(c=12),e.fillRect(g,n+o/4,r,c)}},this.tween_frames=function(t,i){var a=i/2,e=t%i;return e<a?e/a:1-(e-a)/a}},Ball=function(t,i,a,e,l){this.timestamp=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},this.bound=function(t,i,a){return Math.max(i,Math.min(a,t))};var s={BLACK:"#000000",YELLOW:"#ECD078",BRICK:"#D95B43",PINK:"#C02942",PURPLE:"#542437",GREY:"#333",SLATE:"#53777A",GOLD:"gold"};this.x=96,this.y=0,this.alto=50,this.ancho=50,this.center_x=this.x+this.ancho/2,this.center_y=this.y+this.alto/2,this.dx=0,this.dy=0,this.gravity=900,this.maxdx=1500,this.maxdy=1500,this.impulse=550,this.accel=this.maxdx/.001,this.friction=this.maxdx/.001,this.ball=!0,this.start={x:this.x,y:this.y},this.theta=0,this.timestamp=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},this.update=function(t){this.calcula_centro(t),this.ddx=0,this.ddy=this.gravity,this.x=this.x+t*this.dx,this.y=this.y+t*this.dy,this.dy=this.bound(this.dy+t*this.ddy,-this.maxdy,this.maxdy),this.dx=this.dx/1.0004,this.dy>0?this.y+this.alto>600&&(this.dy=.9*-this.dy):this.dy<0&&this.y<=0&&(this.dy=.9*-this.dy),this.dx>0?this.center_x+this.ancho/2>840&&(this.dx=.9*-this.dx):this.dx<0&&this.center_x-this.ancho/2<=0&&(this.dx=.9*-this.dx)},this.calcula_centro=function(t){this.center_x=this.x+this.dx*t+this.ancho/2,this.center_y=this.y+this.dy*t+this.alto/2},this.calcula_rotacion=function(t,i,a,e){var l=0;a&&(l=Math.PI/4),this.theta+=this.dx/1e4;var s=t-this.center_x,n=i-this.center_y,h=s*Math.cos(this.theta+l)-n*Math.sin(this.theta+l),o=s*Math.sin(this.theta+l)+n*Math.cos(this.theta+l),r={};return r.x=h+this.center_x,r.y=o+this.center_y,r},this.render=function(t,i){this.mate?t.fillStyle=s.SLATE:t.fillStyle=s.GOLD;var a=this.calcula_rotacion(this.x+this.dx*i,this.y+this.dy*i,!1,i),e=this.calcula_rotacion(this.x+this.dx*i+this.ancho,this.y+this.dy*i,!1,i),l=this.calcula_rotacion(this.x+this.dx*i+this.ancho,this.y+this.dy*i+this.alto,!1,i),n=this.calcula_rotacion(this.x+this.dx*i,this.y+this.dy*i+this.alto,!1,i);t.beginPath(),t.moveTo(a.x,a.y),t.lineTo(e.x,e.y),t.lineTo(l.x,l.y),t.lineTo(n.x,n.y),t.closePath(),t.fill(),t.globalAlpha=1}},song={songData:[{i:[2,121,128,0,3,201,128,0,0,0,0,6,29,0,0,3,195,4,1,1,50,184,119,244,147,6,131,6],p:[1,1,1,2,1,1,1,2,1,4,4,4,4,4],c:[{n:[140,,140,,140,140,,140,,140,,140,140,140,,,140,,140,,140,140,,140,,140,,140,140,140,,,144,,144,,144,144,,144,,144,,144,144,144,,,144,,144,,144,144,,144,,144,,144,144,144,,,147,,147,,147,147,,147,,147,,147,147,147,,,147,,147,,147,147,,147,,147,,147,147,147],f:[]},{n:[150,,150,,150,150,,150,,150,,150,150,150,,,150,,150,,150,150,,150,,150,,150,150,150,,,154,,154,,154,154,,154,,154,,154,154,154,,,154,,154,,154,154,,154,,154,,154,154,154,,,157,,157,,157,157,,157,,157,,157,157,157,,,157,,157,,157,157,,157,,157,,157,157,157],f:[]},{n:[152,,152,,152,152,,152,,152,,152,152,152,,,135,,135,,135,135,,145,,145,,145,145,145,,,156,,156,,156,156,,156,,156,,156,156,156,,,138,,138,,138,138,,149,,149,,149,149,149,,,159,,159,,159,159,,159,,159,,159,159,159,,,142,,142,,142,142,,152,,152,,152,152,152],f:[]},{n:[135,,135,,135,135,,145,,145,,145,145,145,,,152,,152,,152,152,,152,,152,,152,152,152,,,138,,138,,138,138,,149,,149,,149,149,149,,,156,,156,,156,156,,156,,156,,156,156,156,,,142,,142,,142,142,,152,,152,,152,152,152,,,159,,159,,159,159,,159,,159,,159,159,159],f:[]}]},{i:[1,192,128,0,1,191,116,9,0,0,6,22,34,0,0,0,69,3,1,1,23,167,102,192,77,6,63,6],p:[3,2,1,4,3,2,1,4,,5,6,7],c:[{n:[,,,,,,,,,,,,,147,157,156,156,,,,,147,157,156,157,156,154,152,156,154,152,151],f:[]},{n:[,,,,,,,,,,,,,147,157,156,156,,,,,,,,,,,,,147,152,156],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147,152,156],f:[]},{n:[150,,,,,,,,,,,,145,145,154,150,,,,,,,,,145,145,154,156,154,152,157,156],f:[]},{n:[157,,,156,,,149,,159,,,157,,,156,,157,,,156,,,159],f:[]},{n:[157,,,156,,,149,,159,,,157,,,156,,157,,,156,,,152],f:[]},{n:[157,,,156,,,149,,159,,,157,,,156,,157,,,156,,,159,,,,,,,,,,168,,,164,,,157,,171,,,169,,,168,,169,,,168,,,171],f:[]}]},{i:[0,0,140,0,0,0,140,0,0,60,4,10,34,0,0,0,187,5,0,1,239,135,0,32,108,5,16,4],p:[,,,,1,1,1,1,1,1,1,1,1],c:[{n:[154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154],f:[]}]},{i:[0,255,117,1,0,255,110,0,1,0,4,6,35,0,0,3,0,0,0,3,13,0,1,39,127,5,0,0],p:[,,,,,1,1,1,1,2,2,2,2],c:[{n:[152,,,,152,152,,,152,,,,152,152,,,152,,,,152,152,,,152,,,,152,152],f:[]},{n:[152,,,,,,,152,,152,152,,,,,,152,,,,,,,152,,152,152],f:[]}]},{i:[3,57,128,0,3,68,128,0,1,218,4,4,40,0,0,1,55,4,1,2,99,115,124,190,67,12,39,1],p:[,,,,,1,1,3,1,2,2,2,2],c:[{n:[,,152,,,,152,,,,152,,,,152,,,,152,,,,152,,,,152,,,,152,152],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147,,,,,,,,157,,,,,,,,156,,,,,,,,156],f:[]},{n:[,,150,,,,150,,,,150,,,,150,,,,150,,,,150,,,,150,,,,150,150],f:[]}]},{i:[2,192,128,0,2,192,140,18,0,0,60,57,158,0,0,0,0,0,0,2,5,0,0,32,0,0,24,4],p:[,,,,,,,,,1,1,1,1],c:[{n:[135,,,,,,,133,133,,,,,,,152,152,,,,,,,,,,,,,,,,138,,,,,,,137,137,,,,,,,156,156,,,,,,,,,,,,,,,,142,,,,,,,140,140,,,,,,,159,159,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,140],f:[]}]},{i:[2,192,128,0,2,192,140,18,0,0,107,115,138,0,0,0,136,5,1,2,8,92,21,32,148,5,85,8],p:[,,,,1],c:[{n:[140,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,144,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147],f:[]}]},{i:[2,33,128,0,3,201,128,0,0,0,0,0,58,0,0,0,195,6,1,2,135,63,4,61,147,6,32,6],p:[,,,,1,1,1,2,1,3,3,3,4,4],c:[{n:[116,,116,,116,128,,116,,116,,116,128,116,128,116,116,,116,,116,128,,116,,116,,116,116,128,123,116],f:[]},{n:[114,,114,,114,126,,114,,114,,114,126,114,114,126,114,,114,,114,126,,114,,114,,114,114,126,121,114],f:[]},{n:[123,,126,,130,,,121,,,125,,128,,,128,104,,,,,,,116,,,116,,116,128,116,,,,,,,,,,,,,,,,,,116],f:[]},{n:[123,,,,123,,123,121,,,,121,,121,,121,116,,,,,,,116,,116,116,,,,,,126,,,,126,,126,125,,,,125,,125,,125,123,,,,,,,123,,123,123,,,,,,130,,,,130,,130,128,,,,128,,128,,128,128,,,,,,,128,,128,128],f:[]}]}],rowLen:8269,patternLen:32,endPattern:15},croqueta={songData:[{i:[3,0,128,1,3,151,128,66,1,218,4,4,40,0,0,1,55,4,1,2,67,115,124,190,67,6,39,1],p:[1],c:[{n:[128],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]}],rowLen:113,patternLen:32,endPattern:2},golpe={songData:[{i:[2,100,128,0,0,201,128,17,0,0,0,6,58,156,7,0,61,7,1,2,135,0,0,32,147,6,24,2],p:[1],c:[{n:[128],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]}],rowLen:113,patternLen:32,endPattern:2},levelup={songData:[{i:[1,192,128,1,1,191,116,9,1,0,68,32,34,204,4,0,69,3,1,1,23,167,0,32,121,14,25,6],p:[1],c:[{n:[147,,151,,,147,,,,151,,,,,,,159,,,,,,,,,,,,,,,,,,,,,151,,,,154,,,,,,,163,,,,,,,,,,,,,,,,,,,,,154,,,,,,,,,,,166,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,171],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]}],rowLen:5513,patternLen:32,endPattern:2},CPlayer=function(){var t,i,a,e,l,s=function(t){return Math.sin(6.283184*t)},n=function(t){return t%1*2-1},h=function(t){return t%1<.5?1:-1},o=function(t){var i=t%1*4;return i<2?i-1:3-i},r=function(t){return.003959503758*Math.pow(2,(t-128)/12)},c=function(t,i,a){var e,l,s,n,h,o,c,p=d[t.i[0]],y=t.i[1],m=t.i[3],_=d[t.i[4]],u=t.i[5],f=t.i[8],b=t.i[9],x=t.i[10]*t.i[10]*4,g=t.i[11]*t.i[11]*4,v=t.i[12]*t.i[12]*4,w=1/v,L=t.i[13],E=a*Math.pow(2,2-t.i[14]),O=new Int32Array(x+g+v),I=0,P=0;for(e=0,l=0;e<x+g+v;e++,l++)l>=0&&(L=L>>8|(255&L)<<4,l-=E,o=r(i+(15&L)+t.i[2]-128),c=r(i+(15&L)+t.i[6]-128)*(1+8e-4*t.i[7])),s=1,e<x?s=e/x:e>=x+g&&(s-=(e-x-g)*w),n=o,m&&(n*=s*s),I+=n,h=p(I)*y,n=c,f&&(n*=s*s),P+=n,h+=_(P)*u,b&&(h+=(2*Math.random()-1)*b),O[e]=80*h*s|0;return O},d=[s,h,n,o];this.init=function(s){t=s,i=s.endPattern-2,a=0,e=s.rowLen*s.patternLen*(i+1)*2,l=new Int32Array(e)},this.generate=function(){var n,h,o,r,p,y,m,_,u,f,b,x,g,v,w=new Int32Array(e),L=t.songData[a],E=t.rowLen,O=t.patternLen,I=0,P=0,R=!1,M=[];for(o=0;o<=i;++o)for(m=L.p[o],r=0;r<O;++r){var C=m?L.c[m-1].f[r]:0;C&&(L.i[C-1]=L.c[m-1].f[r+O]||0,C<15&&(M=[]));var S=d[L.i[15]],A=L.i[16]/512,T=Math.pow(2,L.i[17]-9)/E,j=L.i[18],B=L.i[19],D=43.23529*L.i[20]*3.141592/44100,z=1-L.i[21]/255,U=1e-5*L.i[22],N=L.i[23]/32,k=L.i[24]/512,K=6.283184*Math.pow(2,L.i[25]-9)/E,W=L.i[26]/255,F=L.i[27]*E;for(b=(o*O+r)*E,p=0;p<4;++p)if(y=m?L.c[m-1].n[r+p*O]:0){M[y]||(M[y]=c(L,y,E));var Y=M[y];for(h=0,n=2*b;h<Y.length;h++,n+=2)w[n]+=Y[h]}for(h=0;h<E;h++)_=2*(b+h),f=w[_],f||R?(x=D,j&&(x*=S(T*_)*A+.5),x=1.5*Math.sin(x),I+=x*P,g=z*(f-P)-I,P+=x*g,f=3==B?P:1==B?g:I,U&&(f*=U,f=f<1?f>-1?s(.25*f):-1:1,f/=U),f*=N,R=f*f>1e-5,u=Math.sin(K*_)*k+.5,v=f*(1-u),f*=u):v=0,_>=F&&(v+=w[_-F+1]*W,f+=w[_-F]*W),w[_]=0|v,w[_+1]=0|f,l[_]+=0|v,l[_+1]+=0|f}return++a/8},this.createWave=function(){var t=2*e-8,i=t-36,a=new Uint8Array(44+2*e);a.set([82,73,70,70,255&t,t>>8&255,t>>16&255,t>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&i,i>>8&255,i>>16&255,i>>24&255]);for(var s=0,n=44;s<e;++s){var h=l[s];h=h<-32767?-32767:h>32767?32767:h,a[n++]=255&h,a[n++]=h>>8&255}return a},this.getData=function(t,i){for(var a=2*Math.floor(44100*t),e=new Array(i),s=0;s<2*i;s+=1){var n=a+s;e[s]=t>0&&n<l.length?l[n]/32768:0}return e}},Game=function(){this.is_touch_device=function(){return"ontouchstart"in document.documentElement},this.onkey=function(t,i,a){switch(i){case this.KEY.LEFT:return player.left=a,t.preventDefault(),!1;case this.KEY.RIGHT:return player.right=a,t.preventDefault(),!1;case this.KEY.UP:return player.jump=a,t.preventDefault(),!1;case this.KEY.DOWN:return player.down=a,t.preventDefault(),!1;case this.KEY.Z:return player.accion=a,t.preventDefault(),!1}},this.timestamp=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},this.bound=function(t,i,a){return Math.max(i,Math.min(a,t))},this.overlap=function(t,i,a,e,l,s,n,h){return!(t+a-1<l||l+n-1<t||i+e-1<s||s+h-1<i)},this.randInt=function(t,i,a){var e;return!1===a?(e=Math.floor(Math.random()*i)-t,e*=1===Math.floor(2*Math.random())?1:-1):e=Math.floor(Math.random()*i)+t,e},this.pinta_marcador=function(t){marcador_1=this.letras[this.puntos1],marcador_2=this.letras[this.puntos2],this.pinta_filas_columnas(t,16,16,marcador_1,this.marcado_size),this.pinta_filas_columnas(t,this.ancho_total-16-3*this.marcado_size,16,marcador_2,this.marcado_size)},this.pinta_filas_columnas=function(t,i,a,e,l){t.fillStyle="#ffffff";for(var s=i,n=a,h=0,o=0;o<e.length;o++){for(var r=e[o],c=0;c<r.length;c++)r[c]&&t.fillRect(s+c*l,n,l,l);h=Math.max(h,r.length*l),n+=l}s+=l+h},this.update=function(t){this.procesa_punto(),this.calculaDondeCae(),player.update(t),player2.update(t),this.checkBallCollisionNet(),this.checkBallCollision(),ball.update(t)},this.checkBallCollisionNet=function(){this.overlap(net.x,net.y,net.width,net.height,ball.center_x-ball.ancho/2,ball.center_y-ball.alto/2,ball.ancho,ball.alto)&&(ball.center_y<net.y?ball.dy>0&&(ball.dy=-ball.dy*this.FACTOR_REBOTE):(ball.x>this.ancho_total/2?ball.x=this.ancho_total/2+net.width:ball.x=this.ancho_total/2-ball.ancho,ball.dx=-ball.dx*this.FACTOR_REBOTE))},this.checkBallCollision=function(){if(!this.hay_punto){var t=!1,i=!1;if(!player.jumping&&player.haciendo_gorrino){var a=player.alto/2;player.gorrino_left&&(a=-1*player.alto/2),this.overlap(player.x+a,player.y+player.ancho/4,player.alto,player.ancho,ball.center_x-ball.ancho/2,ball.center_y-ball.alto/2,ball.ancho,ball.alto)&&this.timestamp()>player.no_rebota_time&&(t=!0,i=player)}else this.overlap(player.x,player.y,player.ancho,player.alto,ball.center_x-ball.ancho/2,ball.center_y-ball.alto/2,ball.ancho,ball.alto)&&this.timestamp()>player.no_rebota_time&&(t=!0,i=player);if(!player2.jumping&&player2.haciendo_gorrino){var e=player2.alto/2;player2.gorrino_left&&(e=-1*player2.alto/2),this.overlap(player2.x+e,player2.y+player2.ancho/4,player2.alto,player2.ancho,ball.center_x-ball.ancho/2,ball.center_y-ball.alto/2,ball.ancho,ball.alto)&&this.timestamp()>player2.no_rebota_time&&(t=!0,i=player2)}else this.overlap(player2.x,player2.y,player2.ancho,player2.alto,ball.center_x-ball.ancho/2,ball.center_y-ball.alto/2,ball.ancho,ball.alto)&&this.timestamp()>player2.no_rebota_time&&(t=!0,i=player2);if(t){var l=ball.x+ball.ancho/2,s=ball.y+ball.alto/2;if(!i.jumping||i.tiempo_enfadado<this.timestamp()){ball.mate=!1,ball.gravity=900;var n=ball.dy/6-this.IMPULSO_PELOTA;ball.dy=n<0?-1*this.bound(Math.abs(ball.dy/6-this.IMPULSO_PELOTA),this.IMPULSO_PELOTA/1.3,this.IMPULSO_PELOTA):this.bound(ball.dy/6-this.IMPULSO_PELOTA,this.IMPULSO_PELOTA/1.3,this.IMPULSO_PELOTA),ball.dy=-this.IMPULSO_PELOTA,ball.dx=ball.dx/4+(ball.x-i.x)*this.F_ALEJA_X,i.dy=i.dy/this.F_SALTO_COLISION,this.explosions.push(new Explosion(l,s,!1,!1,ball))}else{if(ball.mate=!0,i.no_rebota_time=this.timestamp()+300,i===player)!i.right&&!i.left||i.jump||i.down?i.right&&i.jump&&!i.down?(ball.dy=-700,ball.dx=800,ball.gravity=1400):i.left&&i.jump&&!i.down?(ball.dy=-700,ball.dx=-800,ball.gravity=1400):(i.right||i.left)&&!i.jump&&i.down?(ball.dy=1e3,ball.dx=1e3,ball.gravity=1400):i.right||i.left||i.jump||!i.down?i.right||i.left||i.jump||i.down?i.right||i.left||!i.jump||i.down||(ball.dy=-1e3,ball.dx=300,ball.gravity=1400):(ball.dy=-100,ball.dx=300,ball.gravity=1400):(ball.dy=1e3,ball.dx=800,ball.gravity=1400):(ball.dy=.3*-Math.abs(ball.dy),ball.dy=-300,ball.dx=800,ball.gravity=1500);else{var h=Math.random();h<.4?(ball.dy=-700,ball.dx=-800,ball.gravity=1400):h>=.4&&h<.8?(ball.dy=.3*-Math.abs(ball.dy),ball.dy=-300,ball.dx=-800,ball.gravity=1500):player2.x<.75*this.ancho_total?h<.9?(ball.dy=1e3,ball.dx=-1e3,ball.gravity=1400):(ball.dy=-1e3,ball.dx=-300,ball.gravity=1400):(ball.dy=-this.IMPULSO_PELOTA,ball.dx=ball.dx/4+(ball.x-i.x)*this.F_ALEJA_X,i.dy=i.dy/this.F_SALTO_COLISION)}i.dy=i.dy/this.F_SALTO_COLISION,this.explosions.push(new Explosion(l,s,!0,!1,ball))}i===player2&&i.jumping&&(player2.tiempo_enfadado=this.timestamp())}}},this.procesa_punto=function(){this.tiempo_punto>this.timestamp()?this.hay_punto=!0:(this.hay_punto&&this.empieza(empieza1),this.hay_punto=!1)},this.empieza=function(t){player.x=96,player.y=this.alto_total-player2.alto-50,player2.x=this.ancho_total-96-player2.ancho,player2.y=this.alto_total-player2.alto-50,ball.x=t?112:this.ancho_total-112-ball.ancho,ball.y=20,ball.dx=0,ball.dy=0,ball.center_x=ball.x+ball.ancho/2,ball.center_y=ball.y+ball.alto/2,this.hay_punto=!1};var t=0,i=!1;this.calculaDondeCae=function(){if(!this.hay_punto){var a=ball.center_x,e=this.alto_total-ball.y+ball.alto/2,l=this.alto_total-ball.y+ball.alto/2-(this.alto_total-player2.y),s=ball.dx,n=ball.dy;n<=10&&(n*=-1,t=a+s/ball.ddy*Math.sqrt(2*ball.ddy*l+s),t>this.ancho_total?t=this.ancho_total-(t-this.ancho_total):t<0&&(t=-t));var h=player2.x+player2.ancho/2,o=player2.y+player2.alto/2,r=ball.y+ball.alto/2;if(player2.haciendo_gorrino);else if(t>this.ancho_total/2-50||t>this.ancho_total/2-150&&n<-100){t<h-0&&h>this.ancho_total/2?(player2.left=!0,player2.right=!1):(player2.right=!0,player2.left=!1),Math.abs(t-h)<110&&a>this.ancho_total/2&&o>this.alto_total-200&&s<100&&s>-100&&r<this.alto_total-300&&player2.tiempo_enfadado<this.timestamp()?(player2.jump=!0,player2.tiempo_enfadado=this.timestamp()+700):player2.jump=!1}else{player2.tiempo_enfadado=this.timestamp();var c=this.counter%50;c>48?(ale=Math.random(),ale>.5&&h>this.ancho_total/2?(player2.left=!0,player2.right=!1,i=!0):ale<.5&&(player2.right=!0,player2.left=!1,i=!1)):i?(player2.left=!0,player2.right=!1):(player2.right=!0,player2.left=!1)}var d=this.alto_total/3;!player2.jumping&&e<d&&(t<h&&h>this.ancho_total/2?h-t>100&&a>this.ancho_total/2-50&&!player2.haciendo_gorrino&&(player2.tiempo_gorrino=this.timestamp()+400,player2.gorrino_left=!0):t-h>100&&a>this.ancho_total/2&&!player2.haciendo_gorrino&&(player2.tiempo_gorrino=this.timestamp()+400,player2.gorrino_left=!1))}},this.game_over=function(){},this.siguiente_level=function(){},this.render=function(t,i,a){t.clearRect(0,0,this.ancho_total,this.alto_total),this.renderPlayer(t,a),this.renderplayer2(t,a),ball.render(t,a),this.renderNet(t),this.drawExplosion(t),this.pinta_marcador(t)},this.renderNet=function(t){t.fillStyle=this.COLOR.BRICK,t.fillRect(net.x,net.y,net.width,net.height)},this.renderPlayer=function(t,i){player.haciendo_gorrino?(t.fillStyle=this.COLOR.PINK,player.pinta_player(!0,i,ball,t,this.counter)):(player.tiempo_enfadado>this.timestamp()?t.fillStyle=this.COLOR.PURPLE:t.fillStyle=this.COLOR.YELLOW,player.pinta_player(!1,i,ball,t,this.counter))},this.renderplayer2=function(t,i){if(player2.haciendo_gorrino){t.fillStyle=this.COLOR.PINK;player2.gorrino_left&&-1,player2.pinta_player(!0,i,ball,t,this.counter)}else player2.tiempo_enfadado>this.timestamp()?t.fillStyle=this.COLOR.BLACK:t.fillStyle=this.COLOR.GREY,player2.pinta_player(!1,i,ball,t,this.counter)},this.drawExplosion=function(t){if(0!==this.explosions.length)for(var i=0;i<this.explosions.length;i++){var a=this.explosions[i],e=a.particles;if(0===e.length)return void this.explosions.splice(i,1);for(var l=e.slice(),s=0;s<e.length;s++){var n=e[s];n.size<=0?l.splice(s,1):(t.beginPath(),t.fillRect(n.x,n.y,n.size,n.size),t.closePath(),t.fillStyle="rgb("+n.r+","+n.g+","+n.b+")",t.fill(),n.x+=n.xv,n.y+=n.yv,n.size-=.1)}a.particles=l}},this.muestra_logo=function(t){var i=[[1,1,1,1,,1,1,,1,,,1,,1,,,1,,,1,1,1,,,1,,1,1,,1,1,1,,,1,1,1,1,,,1,1,,1,,1,1,1,1,,1,1,,,,1,1,,,,1,1,1,1,,1,,,1],[1,1,1,1,,1,1,,1,1,,1,,,1,1,,,,1,1,,1,,1,,1,1,,1,1,,1,,1,1,,,,,1,1,,1,,1,1,,1,,1,1,,,,1,1,,,,1,1,,,,,1,1],[,1,1,,,1,1,,1,1,1,1,,,1,1,,,,1,1,,1,,1,,1,1,,1,1,,1,,1,1,1,,,,1,1,,1,,1,1,,1,,1,1,,,,1,1,,,,1,1,1,,,,1,1],[,1,1,,,1,1,,1,,1,1,,,1,1,,,,1,1,,1,,1,,1,1,,1,1,,1,,1,1,,,,,,1,,1,,1,1,,1,,1,1,,,,1,1,,,,1,1,,,,,1,1],[,1,1,,,1,1,,1,,,1,,,1,1,,,,1,1,1,,,1,1,1,1,,1,1,1,,,1,1,1,1,,,,,1,,,1,1,1,1,,1,1,1,1,,1,1,1,1,,1,1,1,1,,,1,1]],a=this.ancho_total/2-8*i[0].length/2;this.pinta_filas_columnas(t,a,200,i,8)},this.pinta_cargador=function(t,i){i.fillRect((this.ancho_total-200)/2,this.alto_total/2+50,200*t,80),i.strokeStyle="#ffffff",i.lineWidth=10,i.strokeRect((this.ancho_total-200)/2,this.alto_total/2+50,195,80)},this.muestra_menu=function(){this.empieza(!0);var t=this;window.setTimeout(function(){t.empezado=!0},5e3)},this.setup=function(){player=new Player(!1,96,!1,!1,!1,1,!1),player2=new Player(!1,1850,!1,!1,!1,2,!1),ball=new Ball;net={height:220,width:12,x:this.ancho_total/2,y:this.alto_total-220}},this.empezado=!1,this.ancho_total=840,this.alto_total=600,this.alto_red=190,this.ancho_jugador=80,this.alto_jugador=110,this.g_jugador=800,this.v_jugador=400,this.v_saltando_jugador=550,this.radio_pelota=20,this.g_pelota=900,this.gravedad_rebote_normal=900,this.velocidad_rebote_normal=-600,this.velocidad_lateral1=800,this.velocidad_lateral_mate=1e3,this.velocidad_lateral3=300,this.velocidad_vertical1=700,this.velocidad_vertical_mate=800,this.velocidad_vertical_dejada=-100,this.velocidad_vertical_arriba=-1e3,this.gravedad_pika1=1500,this.gravedad_pika2=1400,this.gravedad_pika3=1400,this.GRAVITY=800,this.ACCEL=.001,this.FRICTION=.001,this.IMPULSE=2400,this.IMPULSO_PELOTA=600,this.FACTOR_REBOTE=.9,this.F_ALEJA_X=2,this.F_SALTO_COLISION=1.5,this.COLOR={BLACK:"#000000",YELLOW:"#ECD078",BRICK:"#D95B43",PINK:"#C02942",PURPLE:"#542437",GREY:"#333",SLATE:"#53777A",GOLD:"gold"},this.COLORS=[this.COLOR.YELLOW,this.COLOR.BRICK,this.COLOR.PINK,this.COLOR.PURPLE,this.COLOR.GREY],this.KEY={SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,Z:90},this.fps=60,this.step=1/this.fps,this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.width=this.canvas.width=this.ancho_total,this.height=this.canvas.height=this.alto_total,this.player={},this.player2={},this.ball={},this.net={},this.tiempo_punto=this.timestamp(),this.hay_punto=!1,this.puntos1=0,this.puntos2=0,this.explosions=[],this.marcado_size=4,this.letras={0:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],1:[[,,1],[,,1],[,,1],[,,1],[,,1]],2:[[1,1,1],[,,1],[1,1,1],[1,,],[1,1,1]],3:[[1,1,1],[,,1],[1,1,1],[,,1],[1,1,1]],4:[[1,,1],[1,,1],[1,1,1],[,,1],[,,1]],5:[[1,1,1],[1,,],[1,1,1],[,,1],[1,1,1]],6:[[1,1,1],[1,,],[1,1,1],[1,,1],[1,1,1]],7:[[1,1,1],[,,1],[,,1],[,,1],[,,1]],8:[[1,1,1],[1,,1],[1,1,1],[1,,1],[1,1,1]],9:[[1,1,1],[1,,1],[1,1,1],[,,1],[1,1,1]]},this.muestra_logo(this.ctx),this.setup(),this.pinta_cosas_mobile_gira=function(){document.getElementById("controles_mobile").style.display="none",document.getElementById("canvas_mobile").style.display="none";var t=window.innerWidth,i=window.innerHeight;canvas_mobile_gira=document.getElementById("canvas_mobile_gira"),canvas_mobile_gira.style.display="block",ctx_mobile_gira=canvas_mobile_gira.getContext("2d"),canvas_mobile_gira.width=t,canvas_mobile_gira.height=i;var a=[[,,,1,1,1,1,,,,],[,,1,,,,,1,,,],[,1,,,,,,,1,,1],[,1,,,,,,,,1,1],[1,1,1,,,,,,1,1,1],[,,,,,,,,,,],[,,,,,,,,,,],[1,1,1,1,1,1,1,1,1,1,1],[1,,,,,,,,1,1,1],[1,,,,,,,,1,1,1],[1,,,,,,,,1,,1],[1,,,,,,,,1,1,1],[1,,,,,,,,1,1,1],[1,1,1,1,1,1,1,1,1,1,1]],e=t/2-12*a[0].length/2;pinta_filas_columnas(ctx_mobile_gira,e,200,a,12)},this.pinta_cosas_mobile=function(){document.getElementById("canvas_mobile_gira").style.display="none",a=document.getElementById("canvas_mobile"),e=a.getContext("2d"),a.style.display="block";var t=window.innerWidth;a.width=this.ancho_total,a.height=100;var i=[[,1,,],[,1,1],[1,1,1,1],[,1,1],[,1,,]],l=[[,,1],[,1,1],[1,1,1,1],[,1,1],[,,1]],s=[[,,1,,],[,1,1,1],[1,1,1,1,1],[,1,1,1],[,1,1,1]],n=[[1,,1,,1],[,1,1,1],[1,1,1,1,1],[,1,1,1],[1,,1,,1]];this.pinta_filas_columnas(e,20,20,l,12),this.pinta_filas_columnas(e,120,20,i,12),this.pinta_filas_columnas(e,t-180,20,s,12),this.pinta_filas_columnas(e,t-80,20,n,12),document.getElementById("controles_mobile").style.display="block",document.getElementById("der_mobile").addEventListener("touchstart",function(t){player.right=!0,this.className="tecla_mobile pulsada",t.preventDefault()}),document.getElementById("izq_mobile").addEventListener("touchstart",function(t){player.left=!0,this.className="tecla_mobile pulsada",t.preventDefault()}),document.getElementById("arr_mobile").addEventListener("touchstart",function(t){player.jump=!0,this.className="tecla_mobile pulsada",t.preventDefault()}),document.getElementById("accion_mobile").addEventListener("touchstart",function(t){player.accion=!0,this.className="tecla_mobile pulsada",t.preventDefault()}),document.getElementById("der_mobile").addEventListener("touchend",function(t){player.right=!1,this.className="tecla_mobile",t.preventDefault()}),document.getElementById("izq_mobile").addEventListener("touchend",function(t){player.left=!1,this.className="tecla_mobile",t.preventDefault()}),document.getElementById("arr_mobile").addEventListener("touchend",function(t){player.jump=!1,this.className="tecla_mobile",t.preventDefault()}),document.getElementById("accion_mobile").addEventListener("touchend",function(t){player.accion=!1,this.className="tecla_mobile",t.preventDefault()})};var a,e;this.is_touch_device()&&(window.innerHeight>window.innerWidth?this.pinta_cosas_mobile_gira():this.pinta_cosas_mobile(),window.addEventListener("orientationchange",function(t){window.setTimeout(function(){window.innerHeight>window.innerWidth?this.pinta_cosas_mobile_gira():this.pinta_cosas_mobile()},300)}))};!function(){function t(){if(!i.empezado)return void requestAnimationFrame(t,canvas);for(a=i.timestamp(),e+=Math.min(1,(a-l)/1e3);e>i.step;)e-=i.step,i.update(i.step);i.render(i.ctx,i.counter,e),l=a,i.counter++,requestAnimationFrame(t,canvas)}var i=new Game;i.counter=0;var a,e=0,l=i.timestamp();document.addEventListener("keydown",function(t){return i.onkey(t,t.keyCode,!0)},!1),document.addEventListener("keyup",function(t){return i.onkey(t,t.keyCode,!1)},!1);var s=new CPlayer,n=!1;s.init(song);var h=new CPlayer;h.init(croqueta);var o,r=!1,c=new CPlayer;c.init(golpe);var d,p=!1,y=new CPlayer;y.init(levelup);var m=!1,_=!1,u=setInterval(function(){if(_)return i.muestra_menu(),t(),void clearInterval(u);if(!n){var a=s.generate();i.pinta_cargador(a,i.ctx),a>=1&&(n=!0)}if(r||h.generate()>=1&&(r=!0),p||c.generate()>=1&&(p=!0),m||y.generate()>=1&&(m=!0),_=n&&r&&p){var e=s.createWave(),l=document.createElement("audio");l.src=URL.createObjectURL(new Blob([e],{type:"audio/wav"})),l.loop=!0,l.play(),l.volume=.3;var f=h.createWave();o=document.createElement("audio"),o.src=URL.createObjectURL(new Blob([f],{type:"audio/wav"}));var b=c.createWave();d=document.createElement("audio"),d.src=URL.createObjectURL(new Blob([b],{type:"audio/wav"}));var x=y.createWave();y=document.createElement("audio"),y.src=URL.createObjectURL(new Blob([x],{type:"audio/wav"}))}},100)}();